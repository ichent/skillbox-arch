Расчет приведены [здесь](https://github.com/ichent/skillbox-arch/blob/main/final/%D0%90%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7%20%D1%81%D1%82%D0%BE%D0%B8%D0%BC%D0%BE%D1%81%D1%82%D0%B8%20%D0%B2%D0%BB%D0%B0%D0%B4%D0%B5%D0%BD%D0%B8%D1%8F%20%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BC%D0%BE%D0%B9.docx)

<div style="font-family: Arial, sans-serif; line-height: 1.6; color: #333;">

    <h2>16. Анализ стоимости владения системой (TCO Analysis)</h2>

    <p>
        Оценка совокупной стоимости владения (TCO) инфраструктурой произведена для модели развертывания в общедоступном облаке (Public Cloud — на примере <strong>Yandex Cloud</strong>). 
        Использование модели Managed Services (управляемых сервисов Kubernetes, PostgreSQL, Kafka) позволяет снизить операционные расходы на администрирование (OpEx), переложив ответственность за доступность оборудования на провайдера.
    </p>

    <h3>1. Модель роста нагрузки и объемов данных</h3>
    <p>
        Расчет базируется на прогнозе роста базы пользователей и объема генерируемых IoT-данных (телеметрии) в течение 5 лет.
    </p>

    <table border="1" cellpadding="10" cellspacing="0" style="width: 100%; border-collapse: collapse; border: 1px solid #ddd; margin-bottom: 20px;">
        <thead>
            <tr style="background-color: #f2f2f2; text-align: left;">
                <th>Параметр</th>
                <th>Год 1 (MVP & Launch)</th>
                <th>Год 2 (Growth)</th>
                <th>Год 5 (Scale)</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td><strong>Активные пользователи (MAU)</strong></td>
                <td>10 000</td>
                <td>100 000</td>
                <td>1 000 000</td>
            </tr>
            <tr>
                <td><strong>Одновременные сессии (CCU)</strong></td>
                <td>100</td>
                <td>2 500</td>
                <td>25 000</td>
            </tr>
            <tr>
                <td><strong>IoT Телеметрия (в месяц)</strong></td>
                <td>~50 ГБ</td>
                <td>~1 ТБ</td>
                <td>~15 ТБ</td>
            </tr>
            <tr>
                <td><strong>Медиа-хранилище (S3)</strong></td>
                <td>100 ГБ</td>
                <td>2 ТБ</td>
                <td>50 ТБ</td>
            </tr>
        </tbody>
    </table>

    <h3>2. Детализация расходов по этапам развития</h3>

    <h4>Этап 1: Год 1 (Запуск и стабилизация)</h4>
    <p>
        <strong>Цель:</strong> Минимизация затрат для проверки продуктовых гипотез. Отсутствие сложного резервирования.
    </p>
    <ul>
        <li><strong>Compute (K8s):</strong> Кластер из 3 worker-нод (2 vCPU, 4GB RAM).</li>
        <li><strong>Database:</strong> Single-instance PostgreSQL + TimescaleDB на одной ВМ.</li>
        <li><strong>Kafka:</strong> Облегченная конфигурация внутри K8s (без Managed решения).</li>
    </ul>
    <p><em>Оценка расходов: <strong>~$550 / мес.</strong> (Итого: ~$6,600 в год)</em></p>

    <h4>Этап 2: Год 2 (Рост и надежность)</h4>
    <p>
        <strong>Цель:</strong> Обеспечение отказоустойчивости (High Availability). Внедрение репликации.
    </p>
    <ul>
        <li><strong>Compute (K8s):</strong> Включение автоскейлинга (HPA). 5-10 нод (4 vCPU, 8GB RAM).</li>
        <li><strong>Database:</strong> Разделение PostgreSQL и TimescaleDB. Включение репликации (Master-Slave).</li>
        <li><strong>Managed Kafka:</strong> Переход на управляемый кластер (3 брокера) для гарантии доставки событий.</li>
    </ul>
    <p><em>Оценка расходов: <strong>~$2,300 / мес.</strong> (Итого: ~$27,600 в год)</em></p>

    <h4>Этап 3: Год 5 (Масштабирование и оптимизация)</h4>
    <p>
        <strong>Цель:</strong> Оптимизация стоимости хранения больших данных (Big Data). 
        Основные расходы смещаются с вычислений (CPU) на хранение (Storage) и сеть.
    </p>
    <ul>
        <li><strong>Optimization:</strong> Использование прерываемых (Spot) инстансов для аналитики (-70% стоимости).</li>
        <li><strong>Data Lifecycle:</strong> Агрегация старых данных телеметрии и перенос в "холодное" хранилище (Cold Storage).</li>
        <li><strong>Network:</strong> Высокие затраты на CDN и исходящий трафик.</li>
    </ul>
    <p><em>Оценка расходов: <strong>~$11,000 / мес.</strong> (Итого: ~$132,000 в год)</em></p>

    <h3>3. Сводная таблица операционных расходов (OpEx)</h3>

    <table border="1" cellpadding="10" cellspacing="0" style="width: 100%; border-collapse: collapse; border: 1px solid #ddd;">
        <thead>
            <tr style="background-color: #e0e0e0; text-align: left;">
                <th>Категория расходов</th>
                <th>Год 1 ($)</th>
                <th>Год 2 ($)</th>
                <th>Год 5 ($)</th>
                <th>Драйвер роста стоимости</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td><strong>Вычисления (K8s Cluster)</strong></td>
                <td>2,400</td>
                <td>9,600</td>
                <td>45,000</td>
                <td>Микросервисы, HPA при пиках нагрузки</td>
            </tr>
            <tr>
                <td><strong>Базы Данных (Storage IOPS)</strong></td>
                <td>1,800</td>
                <td>8,400</td>
                <td>36,000</td>
                <td>Объем дисков для IoT-данных</td>
            </tr>
            <tr>
                <td><strong>Брокер сообщений (Kafka)</strong></td>
                <td>600</td>
                <td>4,800</td>
                <td>18,000</td>
                <td>Пропускная способность (Throughput)</td>
            </tr>
            <tr>
                <td><strong>Хранилище & CDN (S3, Traffic)</strong></td>
                <td>600</td>
                <td>2,400</td>
                <td>24,000</td>
                <td>Медиа-контент и архивы логов</td>
            </tr>
            <tr>
                <td><strong>Observability (ELK Stack)</strong></td>
                <td>600</td>
                <td>2,400</td>
                <td>9,000</td>
                <td>Сбор логов с тысяч контейнеров</td>
            </tr>
            <tr style="background-color: #f9f9f9; font-weight: bold;">
                <td>ИТОГО (в год)</td>
                <td>$ 6,600</td>
                <td>$ 27,600</td>
                <td>$ 132,000</td>
                <td></td>
            </tr>
            <tr style="background-color: #dff0d8; font-weight: bold;">
                <td>Стоимость владения на 1 пользователя</td>
                <td>$ 0.66</td>
                <td>$ 0.27</td>
                <td>$ 0.13</td>
                <td>Экономия масштаба (Economy of Scale)</td>
            </tr>
        </tbody>
    </table>

    <h3>4. Выводы по экономике архитектуры</h3>
    <ul>
        <li><strong>Эффективность масштабирования:</strong> Удельная стоимость обслуживания одного пользователя снижается в 5 раз к пятому году ($0.66 &rarr; $0.13). Это подтверждает эффективность выбора микросервисной архитектуры и Kubernetes.</li>
        <li><strong>Влияние IoT-нагрузки:</strong> Существенная доля затрат (около 30%) приходится на инфраструктуру обработки данных в реальном времени (Kafka + TimescaleDB).</li>
        <li><strong>Риск хранения данных:</strong> Без внедрения политик Data Retention (удаление сырых данных старше 1 года) стоимость хранения в 5-й год может вырасти экспоненциально, что потребует оптимизации на уровне приложения.</li>
    </ul>

</div>